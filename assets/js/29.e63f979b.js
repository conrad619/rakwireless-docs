(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{416:function(e,t,a){"use strict";a.r(t);var s=a(28),n=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"amazon-web-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amazon-web-service"}},[e._v("#")]),e._v(" Amazon Web Service")]),e._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#installing-chirpstack"}},[e._v("Installing Chirpstack")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#installing-the-gateway-bridge"}},[e._v("Installing the Gateway Bridge")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#amazon-web-service-security"}},[e._v("Amazon Web Service Security")])]),e._v(" "),a("li",[a("a",{attrs:{href:"#configuring-the-gateway"}},[e._v("Configuring the Gateway")])])]),e._v(" "),a("p",[e._v("This document walks through the details on the steps on how to configure the free cloud services of "),a("a",{attrs:{href:"http://aws.amazon.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon"),a("OutboundLink")],1),e._v(" to work with your "),a("strong",[e._v("RAK7249 Macro Outdoor Gateway")]),e._v(". Follow each and every step discussed in this document to have a fully functional system. If you encounter errors, kindly contact us through the email provided in the Product Overview.")]),e._v(" "),a("h3",{attrs:{id:"creating-an-account"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#creating-an-account"}},[e._v("#")]),e._v(" Creating an Account")]),e._v(" "),a("p",[e._v("To enjoy the free cloud services of Amazon, make an account through their "),a("a",{attrs:{href:"http://aws.amazon.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Amazon Web Service"),a("OutboundLink")],1),e._v(" page.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("Considerations:\n  1. Limited to 750 hours per month for a period of 12 months\n  2. A debit card must be linked to verify your identity in order to use the service.\n")])])]),a("h3",{attrs:{id:"configuring-the-instance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-instance"}},[e._v("#")]),e._v(" Configuring the Instance")]),e._v(" "),a("ol",[a("li",[e._v("After you have logged into your account, you need to select what instance you are going to be running.")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v('For the purpose of this tutorial, we are going to be using "'),a("strong",[e._v("EC2")]),e._v('". Select it in the '),a("strong",[e._v("AWS Management Console")]),e._v(".")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/1.aws-console.png",width:"100%",caption:"AWS Management Console"}}),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("In the following screen you can see your running instances, key pairs, security groups, etc. Press the blue ‚Äú"),a("strong",[e._v("Launch instance")]),e._v("‚Äù button.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/2.launch-instance.png",width:"100%",caption:"Launching an Instance"}}),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("There is a ton of choices for the operating system, however "),a("strong",[e._v("Ubuntu")]),e._v(" will be used for tutorial. Scroll down and choose "),a("strong",[e._v("Ubuntu Server 18.04 LTS")]),e._v(" (latest at the time of this document). Click the ‚Äú"),a("strong",[e._v("Select")]),e._v("‚Äù button.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/3.selecting-os.png",width:"100%",caption:"Selecting the Operating System"}}),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("In the next window, you can configure your Instance. However, leave it as it is. Just select the "),a("em",[a("strong",[e._v("t2.Micro")])]),e._v(" for the "),a("strong",[e._v("instance type")]),e._v(" as in Figure 4 shown below and click ‚Äú"),a("strong",[e._v("Review and Launch")]),e._v("‚Äù.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/4.select-instance-type.png",width:"100%",caption:"Selecting the Instance Type"}}),e._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[e._v("Confirm your choice and Launch. Security groups will be edited in the next section so you can go ahead and confirm your choice by pressing the ‚Äú"),a("strong",[e._v("Launch")]),e._v("‚Äù button as shown in Figure 5 below.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/5.launch-instance-f.png",width:"100%",caption:"Launching the Instance"}}),e._v(" "),a("h3",{attrs:{id:"accessing-instance-via-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#accessing-instance-via-ssh"}},[e._v("#")]),e._v(" Accessing Instance via SSH")]),e._v(" "),a("p",[e._v("To have an SSH session to the Instance, you nee to create the appropriate access keys. Thus, after Launching, you will see window the same as Figure 6 below.")]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/6.key-pair.png",width:"75%",caption:"Key pair creation"}}),e._v(" "),a("ol",[a("li",[e._v('We will choose to "'),a("strong",[e._v("Create a new key pair")]),e._v('" from the drop-down menu and give it an appropriate name. Finally, click the ‚Äú'),a("strong",[e._v("Download Key Pair")]),e._v("‚Äù button shown in Figure 7.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/7.new-key-pair.png",width:"75%",caption:"Creating a new key pair"}}),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[e._v('After saving the Keys to your chosen location, you can Launch the instance via the blue button "'),a("strong",[e._v("Launch Instances")]),e._v('".')])]),e._v(" "),a("li",[a("p",[e._v("In Figure 8, you can see the parameters of your instance. Note the fields in the highlighted with the red rectangle. These are you real "),a("strong",[e._v("URL")]),e._v(" and "),a("strong",[e._v("IP Address")]),e._v(" for accessing this instance.")])])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("The URL and IP Address shown in Figure 8 are just examples. You will have a different set of information on your setup.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/8.instance-param.png",width:"100%",caption:"Instance Parameters"}}),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[e._v("In order to have SSH access to the Instance we will use "),a("a",{attrs:{href:"https://www.putty.org/",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[e._v("PuTTY")]),a("OutboundLink")],1),e._v(". Download and install it.")])]),e._v(" "),a("li",[a("p",[e._v("In the "),a("strong",[e._v("AWS Instance")]),e._v(" page, mark your instance and click ‚Äú"),a("strong",[e._v("Connect")]),e._v("‚Äù. This will bring the instructions page out. Follow the procedure as well.")])])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("Convert first the keys from "),a("code",[e._v(".pem")]),e._v(" format to "),a("code",[e._v(".ppk")]),e._v(" format as this is what PuTTY is used for. This is done with PuTTYgen, which comes standard with the PuTTY package.")])]),e._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[a("p",[e._v("Run "),a("strong",[e._v("PuTTYgen")]),e._v(" (if you are using Windows, just type it in the start menu after installing PuTTY and you will find it).")])]),e._v(" "),a("li",[a("p",[e._v("In the main window, select the "),a("strong",[e._v("Type of key to generate")]),e._v(" as "),a("strong",[e._v("RSA")]),e._v(" (should be the default choice). In older versions, it is named "),a("strong",[e._v("SSH-2 RSA")]),e._v(".")])])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/9.puttygen.png",width:"75%",caption:"PuTTYgen main window"}}),e._v(" "),a("ol",{attrs:{start:"8"}},[a("li",[a("p",[e._v("Press ‚Äú"),a("strong",[e._v("Load")]),e._v("‚Äù in order to select the key files generated by AWS (make sure to select "),a("strong",[e._v("All Files ("),a("em",[e._v(".")]),e._v(")")]),e._v(" from the drop down menu as by default only "),a("strong",[e._v(".ppk")]),e._v(" files are shown")])]),e._v(" "),a("li",[a("p",[e._v("After successfully loading the keys, you can save them in "),a("strong",[e._v(".ppk")]),e._v(" with the ‚Äú"),a("strong",[e._v("Save private key")]),e._v("‚Äù button. Use the same name as the original "),a("strong",[e._v(".pem")]),e._v(" file. The "),a("strong",[e._v("ppk")]),e._v(" extension will be added automatically. PuTTYgen displays a warning about saving the keys without a passphrase. Ignore it an choose "),a("strong",[e._v("Yes")]),e._v(".")])])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("A passphrase on a private key is an extra layer of protection. Even if your private key is discovered, it cannot be used without the passphrase. The downside to using a passphrase is that it makes automation harder because human intervention is needed to log on to an instance, or to copy files to an instance.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/10.puttygen-public-key.png",width:"75%",caption:"PuTTYgen Saving the public key"}}),e._v(" "),a("ol",{attrs:{start:"10"}},[a("li",[e._v("As your Private Key is now in the correct format, now you can create an SSH session with PuTTY. Open the client and select SSH.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/11.putty-main.png",width:"75%",caption:"PuTTY main window"}}),e._v(" "),a("ol",{attrs:{start:"11"}},[a("li",[e._v("You need the correct "),a("strong",[e._v("Host Name")]),e._v(". Take note of the Host Name syntax provided below together with an example for a better understanding:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("user_name@public_dns_name\n")])])]),a("ul",[a("li",[a("strong",[e._v("Example")]),e._v(":\n"),a("ul",[a("li",[a("strong",[e._v("user_name")]),e._v(": ubuntu")]),e._v(" "),a("li",[a("strong",[e._v("public_dns_name")]),e._v(": ec2-3-120-237-38.eu-central-1.compute.amazonaws.com")]),e._v(" "),a("li",[a("strong",[e._v("Host name")]),e._v(": "),a("a",{attrs:{href:"mailto:ubuntu@ec2-3-120-237-38.eu-central-1.compute.amazonaws.com"}},[e._v("ubuntu@ec2-3-120-237-38.eu-central-1.compute.amazonaws.com")])]),e._v(" "),a("li",[e._v('To know more about "'),a("strong",[e._v("public_dns___name")]),e._v('" , follow the instructions shown in Figure 12.')])])])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/12.public-dns-name.jpg",width:"75%",caption:"Knowing your Public DNS Name"}}),e._v(" "),a("ul",[a("li",[e._v("Afterwhich, fill-in the corresponding Host Name as shown in Figure 13 below.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/13.putty-hostname.png",width:"75%",caption:"PuTTY main window with Host Name"}}),e._v(" "),a("ol",{attrs:{start:"12"}},[a("li",[e._v("Now, you need to tell PuTTY to use the keys. In the "),a("strong",[e._v("Category panel")]),e._v(", expand "),a("strong",[e._v("Connections>SSH>Auth")]),e._v(". Click the ‚Äú"),a("strong",[e._v("Browse")]),e._v("‚Äù button and look for you "),a("strong",[e._v(".ppk")]),e._v(" file")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("If you want to save this configuration for future use, go back to the "),a("strong",[e._v("Session")]),e._v(" tab and enter a name in the "),a("strong",[e._v("Saved Session")]),e._v(" text box and click "),a("strong",[e._v("Save")]),e._v(".")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/14.putty-ssh-auth.png",width:"75%",caption:"PuTTY SSH Authentication"}}),e._v(" "),a("ol",{attrs:{start:"13"}},[a("li",[e._v("Click the ‚Äú"),a("strong",[e._v("Open")]),e._v("‚Äù button to initiate the session. If this is your first time connecting, PuTTY will ask for confirmation (click "),a("strong",[e._v("Yes")]),e._v("). You should see the command line window to your instance now.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/15.putty-ssh-command.png",width:"75%",caption:"PuTTY SSH Command line"}}),e._v(" "),a("h1",{attrs:{id:"installing-chirpstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installing-chirpstack"}},[e._v("#")]),e._v(" Installing Chirpstack")]),e._v(" "),a("p",[e._v("It is always a good idea to make an update and upgrade of your packages. In order to do so run the following commands in the terminal:")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" update\n")])])]),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" upgrade\n")])])]),a("ol",[a("li",[e._v("After the procedure is completed, install ChirpStack and its dependencies. To do this, first we need to install Git with the command:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Next, we "),a("strong",[e._v("clone")]),e._v(" the "),a("strong",[e._v("RAKwireless Ubuntu")]),e._v(" ChirpStack repository:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("git")]),e._v(" clone https://github.com/RAKWireless/ChirpStack_on_Ubuntu\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[e._v("After the cloning is complete, open the newly created folder with the command:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" ChirpStack_on_ubuntu\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Run the installation script:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./install.sh\n")])])]),a("ol",{attrs:{start:"5"}},[a("li",[e._v("After the installation is completed, check if all went well by executing these commands:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("journalctl -u chirpstack-network-server -f -n "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("50")]),e._v("\n")])])]),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("journalctl -u chirpstack-application-server -f -n "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("50")]),e._v("\n")])])]),a("ol",{attrs:{start:"6"}},[a("li",[e._v("You should see no errors as in Figure 16. Make sure you interrupt the output of the commands above with the key combination ‚ÄúCtrl+z‚Äù so you can continue with the configuration process.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/16.chirpstack-journal.png",width:"100%",caption:"ChirpStack Journal Control Output (no errors)"}}),e._v(" "),a("p",[e._v("In case you want to use the Semtech Packet Forwarder to connect your Gateway to the LoRa Network Server proceed "),a("a",{attrs:{href:"#installing-the-gateway-bridge"}},[e._v("here")]),e._v(". If you are going to use the MQTT Bridge instead proceed directly "),a("a",{attrs:{href:"#amazon-web-service-security"}},[e._v("here")])]),e._v(" "),a("ul",[a("li",[e._v("Below is the text form of the logs shown in Figure 16:")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('ubuntu@ip-172-31-33-125:~$ journalctl -u chirpstack-network-server -f -n 50\n-- Logs begin at Wed 2020-06-17 11:59:21 UTC. --\nJun 18 10:20:29 ip-172-31-33-125 systemd[1]: Started ChirpStack Network Server.\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="starting ChirpStack Network Server" band=EU_863_870 docs="https://www.chirpstack.io/" net_id=000000 version=3.9.0\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="storage: setting up storage module"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="storage: setting up Redis client"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="storage: connecting to PostgreSQL"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="storage: applying PostgreSQL data migrations"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="storage: PostgreSQL data migrations applied" count=0\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="gateway/mqtt: connecting to mqtt broker" server="tcp://localhost:1883"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="no geolocation-server configured"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="configuring join-server client" ca_cert= server="http://localhost:8003" tls_cert= tls_key=\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="backend/gateway: connected to mqtt server"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="gateway/mqtt: subscribing to gateway event topic" qos=0 topic=gateway/+/event/+\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="api: starting network-server api server" bind="0.0.0.0:8000" ca-cert= tls-cert= tls-key=\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="starting downlink device-queue scheduler"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-network-server[5588]: time="2020-06-18T10:20:29Z" level=info msg="starting multicast scheduler"\n^Z\n[4]+  Stopped                 journalctl -u chirpstack-network-server -f -n 50\nubuntu@ip-172-31-33-125:~$ journalctl -u chirpstack-application-server -f -n 50\n-- Logs begin at Wed 2020-06-17 11:59:21 UTC. --\nJun 18 10:20:29 ip-172-31-33-125 systemd[1]: Started ChirpStack Application Server.\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="starting ChirpStack Application Server" docs="https://www.chirpstack.io/" version=3.10.0\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: setting up storage package"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: setup metrics"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: setting up Redis client"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: connecting to PostgreSQL database"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: applying PostgreSQL data migrations"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="storage: PostgreSQL data migrations applied" count=1\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="integration/mqtt: TLS config is empty"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="integration/mqtt: connecting to mqtt broker" server="tcp://localhost:1883"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-application-server[5591]: time="2020-06-18T10:20:29Z" level=info msg="api/as: starting application-server api" bind="0.0.0.0:8001" ca_cert= tls_cert= tls_key=\n')])])]),a("h1",{attrs:{id:"installing-the-gateway-bridge"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#installing-the-gateway-bridge"}},[e._v("#")]),e._v(" Installing the Gateway Bridge")]),e._v(" "),a("p",[e._v("In this section, an outline is provided on how to perform the installation. For detailed information, you can visit "),a("a",{attrs:{href:"https://www.chirpstack.io/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Chirpstack.io"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("ol",[a("li",[e._v("Run the following commands provided below to update the Ubuntu Repositories.")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 1CE2AFD36DBCCA00\n")])])]),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("echo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"deb https://artifacts.loraserver.io/packages/3.x/deb stable main"')]),e._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("tee")]),e._v(" /etc/apt/sources.list.d/loraserver.list\n")])])]),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" update\n")])])]),a("ul",[a("li",[e._v("This updates the Ubuntu Repositories.")])]),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Proceed with installing the Bridge itself:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt-get")]),e._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" lora-gateway-bridge\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[e._v("Start the Bridge service:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl start lora-gateway-bridge\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Check if it is working as it should using the command as shown same with the snippet below:")])]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("journalctl -u lora-gateway-bridge -f -n "),a("span",{pre:!0,attrs:{class:"token number"}},[e._v("50")]),e._v("\n")])])]),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/17.gateway-bridge-journal.png",width:"100%",caption:"Gateway Bridge Journal Control Output (no errors)"}}),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('ubuntu@ip-172-31-33-125:~$ journalctl -u chirpstack-gateway-bridge -f -n 50\n-- Logs begin at Wed 2020-06-17 11:59:21 UTC. --\nJun 18 10:20:29 ip-172-31-33-125 systemd[1]: Started ChirpStack Gateway Bridge.\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-gateway-bridge[5596]: time="2020-06-18T10:20:29Z" level=info msg="starting ChirpStack Gateway Bridge" docs="https://www.chirpstack.io/gateway-bridge/" version=3.8.0\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-gateway-bridge[5596]: time="2020-06-18T10:20:29Z" level=info msg="backend/semtechudp: starting gateway udp listener" addr="0.0.0.0:1700"\nJun 18 10:20:29 ip-172-31-33-125 chirpstack-gateway-bridge[5596]: time="2020-06-18T10:20:29Z" level=info msg="integration/mqtt: connected to mqtt broker"\n')])])]),a("h1",{attrs:{id:"amazon-web-service-security"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#amazon-web-service-security"}},[e._v("#")]),e._v(" Amazon Web Service Security")]),e._v(" "),a("p",[e._v("By default, all inbound traffic to an AWS Instance is blocked, only port 22 (SSH) is open. You need to add a set of rules in order for the Gateway and LoRa¬Æ Network Server to be able to communicate:")]),e._v(" "),a("ul",[a("li",[e._v("The Semtech Packet Forwarder needs "),a("strong",[e._v("UDP port 1700")]),e._v(";")]),e._v(" "),a("li",[e._v("MQTT Bridge (unsecured) needs "),a("strong",[e._v("TCP port 1883")]),e._v(";")]),e._v(" "),a("li",[e._v("MQTT Bridge (secured) needs "),a("strong",[e._v("TCP port 8883")]),e._v(";")]),e._v(" "),a("li",[e._v("Chirpstack Web Ui needs "),a("strong",[e._v("TCP port 8080")]),e._v(".")])]),e._v(" "),a("ol",[a("li",[e._v("Open the Security Groups tab in the AWS Dashboard:")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/18.aws-sec-group.png",width:"100%",caption:"AWS Security Groups"}}),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v("Select your desired Security Group ("),a("strong",[e._v("Ubuntu Instance")]),e._v("). If you have multiple instances you can use the date and time of creation of the group as a guide to which is the one you want. Click the ‚Äú"),a("strong",[e._v("Action")]),e._v("‚Äù button and from the drop-down menu select "),a("strong",[e._v("Edit Inbound Rules")]),e._v(":")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/19.inbound-rules.png",width:"100%",caption:"Security Group Inbound Rules"}}),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("In the opened window, press the ‚Äú"),a("strong",[e._v("Add Rule")]),e._v("‚Äù button and add all the 4 rules mentioned before.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/20.add-inbound-rules.png",width:"100%",caption:"Adding Inbound Rules"}}),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("It is a good practice to name them in accordance with what each of them represents.")])]),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[a("p",[e._v("Make sure to "),a("strong",[e._v("Save")]),e._v(" with the button in the lower right corner.")])]),e._v(" "),a("li",[a("p",[e._v("Finally, check if the rules you created are working by entering your instance Public IP address using port 8080 in a browser window. You should see the Login page of the Chirpstack Web UI (for example "),a("code",[e._v("3.120.237.38:8080")]),e._v(" as in the image below).")])])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/21.chirpstack-login.jpg",width:"100%",caption:"Chirpstack Login Page"}}),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("The log-in credentials are provided below. Also, there are profiles created in the RAKwireless Chirpstack installation, so you do not need to make those yourself and you can directly proceed to adding your Gateway.")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Username")]),e._v(": admin")]),e._v(" "),a("li",[a("strong",[e._v("Password")]),e._v(": admin")])])]),e._v(" "),a("h1",{attrs:{id:"configuring-the-gateway"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuring-the-gateway"}},[e._v("#")]),e._v(" Configuring the Gateway")]),e._v(" "),a("h2",{attrs:{id:"packet-forwarder-set-up"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#packet-forwarder-set-up"}},[e._v("#")]),e._v(" Packet Forwarder Set-up")]),e._v(" "),a("ol",[a("li",[e._v("In the Web Management Platform, navigate through "),a("strong",[e._v("LoRa¬Æ Network > Network Settings > Packet Forwarder Settings > General Setup")]),e._v(", and set the Protocol in the drop-down list to "),a("strong",[e._v("Semtech UDP GWMP Protocol")]),e._v(". You only need to change the Server Address to forward the traffic to your ChirpStack running on the Ubuntu Instance (AWS). Enter your Instance Public IP Address in the field marked with the red rectangle in the image below:")])]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),a("p",[e._v("Read the "),a("RouterLink",{attrs:{to:"/Knowledge-Hub/Learn/Resources/Web-Management-Platform/#lora¬Æ-network"}},[e._v("LoRa Network")]),e._v(" section in the Web Management Platform to know more about the other modes aside from the Packet Forwarder Setup.")],1)]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/22.chirpstack-packet-forwader.png",width:"100%",caption:"ChirpStack Packet Forwarder Configuration"}}),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[e._v('Click "'),a("strong",[e._v("Save and Apply")]),e._v('" and go to your ChirpStack Web UI running on the AWS Instance (IP Address:8080). Go to the Gateway tab. Press the ‚Äú'),a("strong",[e._v("Create")]),e._v("‚Äù button.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/23.chirpstack-add-gateway.png",width:"100%",caption:"ChirpStack Gateways Creation"}}),e._v(" "),a("ol",{attrs:{start:"3"}},[a("li",[e._v("In the next window, input the "),a("strong",[e._v("Gateway Name, EUI and Description")]),e._v(". Select a network server and Service Profile from the drop-down menu (remember those are pre-configured with the RAKwireless image). Then, click the ‚Äú"),a("strong",[e._v("Create Gateway")]),e._v("‚Äù button.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/24.chirpstack-gateway-param.png",width:"100%",caption:"ChirpStack Gateway Parameters"}}),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Assuming you entered the parameters correctly you should see your Gateway status as seen is a few second in the Gateway Details tab. You can also monitor Live LoRa Frames in the tab with the same name to see incoming traffic.")])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/25.chirpstack-gateway-details.png",width:"100%",caption:"ChirpStack Gateway Details"}}),e._v(" "),a("h2",{attrs:{id:"mqtt-bridge-set-up"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mqtt-bridge-set-up"}},[e._v("#")]),e._v(" MQTT Bridge Set-up")]),e._v(" "),a("p",[e._v("If you want to use the MQTT Bridge to forward your LoRa¬Æ Traffic to your LoRa¬Æ Network Server, you need to configure your Gateway use the Bridge instead of the Packet Forwarder.")]),e._v(" "),a("ol",[a("li",[e._v("Navigating through "),a("strong",[e._v("LoRa¬Æ Network-> Network Settings-> Packet Forwarder Settings-> General Setup")]),e._v(", set the Protocol in the drop-down list to "),a("strong",[e._v("LoRa¬Æ Gateway MQTT Bridge")]),e._v('. Then, click "'),a("strong",[e._v("Save and Apply")]),e._v('".')])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/26.chirpstack-mqtt-bridge.png",width:"100%",caption:"Gateway MQTT Bridge Protocol"}}),e._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[e._v("Next, choose the type of LoRa Network Server you are going to be using.")])]),e._v(" "),a("li",[a("p",[e._v("Set the address to the address of the AWS Instance and the "),a("strong",[e._v("port to 1883")]),e._v(", "),a("strong",[e._v("Save and Apply")]),e._v(".")])])]),e._v(" "),a("rk-img",{attrs:{src:"/assets/images/deployment-guide/amazon-web-service/27.chirpstack-gateway-mqtt-param.png",width:"100%",caption:"Gateway MQTT Bridge Parameters"}}),e._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[e._v("Lastly, register your Gateway to Chirpstack if you have not done so. You can follow the steps undergone in the Packet Forwarder Set-up section of the "),a("RouterLink",{attrs:{to:"/Knowledge-Hub/Learn/Resources/Web-Management-Platform/#lora¬Æ-network"}},[a("strong",[e._v("Web Management Platform")])]),e._v(" document.")],1)])],1)}),[],!1,null,null,null);t.default=n.exports}}]);