(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{430:function(e,t,n){"use strict";n.r(t);var a=n(28),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"rak-industrial-lpwan-gateway-remote-management-openvpn"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rak-industrial-lpwan-gateway-remote-management-openvpn"}},[e._v("#")]),e._v(" RAK Industrial LPWAN Gateway Remote Management - OpenVPN")]),e._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"#openvpn-server-deployment"}},[e._v("OpenVPN Server Deployment")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#openvpn-management-client-set-up"}},[e._v("OpenVPN Management Client Set-up")])]),e._v(" "),n("li",[n("a",{attrs:{href:"#openvpn-client-set-up-on-lora-gateway"}},[e._v("OpenVPN Client Set-up on LoRa Gateway")])])]),e._v(" "),n("p",[e._v("This section introduces a remote management of RAK Industrial LPWAN Gateways based on OpenVPN. A virtual private network (VPN) is created where a server is deployed that both the gateway and any number of customer devices such as PC and phone, can connect via a public IP address. This is possible to implement using any of the backhaul connectivity options the Gateway supports (Ethernet, Wi-Fi, LTE).")]),e._v(" "),n("p",[e._v("Thus, by connecting to the server via a remote client, the user can remotely manage the RAK Gateway from any point, at any time.")]),e._v(" "),n("h2",{attrs:{id:"network-topology"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#network-topology"}},[e._v("#")]),e._v(" Network Topology")]),e._v(" "),n("p",[e._v("Figure 1 below shows the interconnection of gateways and the end-user using OpenVPN server.")]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/network-topology.png",width:"100%",caption:"Network Topology"}}),e._v(" "),n("h1",{attrs:{id:"openvpn-server-deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#openvpn-server-deployment"}},[e._v("#")]),e._v(" OpenVPN Server Deployment")]),e._v(" "),n("p",[e._v("Before proceeding to this tutorial, make sure you already have an AWS EC2 Instance with Ubuntu Server 18.04 LTS running on it. Else, go back to "),n("RouterLink",{attrs:{to:"/Knowledge-Hub/Learn/Resources/Amazon-Web-Service/#configuring-the-instance"}},[e._v("Amazon Web Service Configurations")]),e._v(" section.")],1),e._v(" "),n("p",[e._v("Assuming that it is already done, follow thoroughly the steps provided below:")]),e._v(" "),n("ol",[n("li",[e._v("Install OpenVPN.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("apt")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" openvpn -y\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[e._v("Download a certificate management tool suite: Easy RSA.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("wget")]),e._v(" https://github.com/OpenVPN/easy-rsa/archive/v3.0.6.tar.gz -O easyrsa.tar.gz\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("Initialize Easy RSA to generate a CA certificate and a server certificate.")])]),e._v(" "),n("ul",[n("li",[e._v("Extract and copy easyrsa to /etc/openvpn/easyrsa/")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p /etc/openvpn/easyrsa \n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("tar")]),e._v(" zxvf easyrsa.tar.gz \n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("cp")]),e._v(" -rf easy-rsa-3.0.6/easyrsa3/* /etc/openvpn/easyrsa/\n")])])]),n("ul",[n("li",[e._v("Initialize the pki.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/openvpn/easyrsa\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa init-pki\n")])])]),n("ul",[n("li",[e._v("Generate the CA certificate.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa build-ca\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("Enter the required information according to the prompt. When asked for a password, make sure to write it down as it will be required later on.")])]),e._v(" "),n("ul",[n("li",[e._v("Generate the Server certificate.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa build-server-full server nopass\n")])])]),n("ul",[n("li",[e._v("Generate the DH parameters file.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa gen-dh\n")])])]),n("ul",[n("li",[e._v("Generate the crl.pem file.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa gen-crl\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[e._v("Generate the OpenVPN Server configuration and running files.")])]),e._v(" "),n("ul",[n("li",[e._v("Create the OpenVPN server configuration file and fill it in. The file must reside in:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("mkdir")]),e._v(" -p /etc/openvpn/server\n")])])]),n("ul",[n("li",[e._v("Open the created file for editing:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/openvpn/server/config.ovpn\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("Change the local "),n("code",[e._v("123.56.96.211")]),e._v(" IP address with your private AWS IP.")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/aws-instance-private-ip.png",width:"100%",caption:"AWS Instance Private IP"}}),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("Add an inbound rule in the AWS Security Group for "),n("strong",[e._v("UDP port 1194")]),e._v(".")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/security-group-inbound-rules.png",width:"100%",caption:"Security Group Inbound Rules"}}),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# openvpn server ")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/openvpn/server\ndaemon\ndev tap\nproto udp\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#local ipaddr to bind. Change it with Server IP.")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("local")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("123.56")]),e._v(".96.211 \nport "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1194")]),e._v("\n\nserver-bridge "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.1 "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("255.255")]),e._v(".255.0 "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.11 "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.100\nifconfig-pool-persist ip_pool.txt\n\nup interface-up.sh\n\nclient-to-client\nkeepalive "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("120")]),e._v("\ncomp-lzo\nuser root\ngroup root\npersist-key\npersist-tun\n\nca /etc/openvpn/easyrsa/pki/ca.crt\ncert /etc/openvpn/easyrsa/pki/issued/server.crt\nkey /etc/openvpn/easyrsa/pki/private/server.key\ndh /etc/openvpn/easyrsa/pki/dh.pem\ncrl-verify /etc/openvpn/easyrsa/pki/crl.pem\n\n\nstatus /var/log/openvpn-status-server.log\nlog /var/log/openvpn-server.log\nverb "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("\nscript-security "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v("\n")])])]),n("ul",[n("li",[e._v("Create a virtual tap interface and fill in the interface-up.sh.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/openvpn/server/interface-up.sh\n")])])]),n("ul",[n("li",[e._v("Fill in the content of the file with the lines below:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[e._v("#!/bin/sh")]),e._v("\n/sbin/ifconfig "),n("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$1")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.1 netmask "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("255.255")]),e._v(".255.0 broadcast "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.0\n")])])]),n("ul",[n("li",[e._v("Make the script executable:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("chmod")]),e._v(" +x /etc/openvpn/server/interface-up.sh\n")])])]),n("ol",{attrs:{start:"5"}},[n("li",[e._v("Start OpenVPN.")])]),e._v(" "),n("ul",[n("li",[e._v("To run the instance startup in the OpenVPN, run the following command:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("enable")]),e._v(" openvpn\n")])])]),n("ul",[n("li",[e._v("Execute the following in order to get your tap interface up:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" openvpn --config /etc/openvpn/server/config.ovpn\n")])])]),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("If you want OpenVPN to execute the configuration file automatically, you should rename the "),n("strong",[e._v("config.ovpn to config.conf")]),e._v(" and move it to the "),n("strong",[e._v("/etc/openvpn folder")]),e._v(".")]),e._v(" "),n("p",[e._v("This way, if the Operating System is rebooted, OpenVPN will automatically load the tap interface.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/openvpn/server\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("mv")]),e._v(" config.ovpn /etc/openvpn/config.conf\n")])])]),n("p",[e._v("You should see a similar output if the tap0 interface is up and running.")]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[e._v("tap0: "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("flags")]),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("416")]),n("span",{pre:!0,attrs:{class:"token operator"}},[n("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[e._v("3")]),e._v("<")]),e._v("UP,BROADCAST,RUNNING,MULTICAST"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("  mtu "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1500")]),e._v("\n        inet "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.1  netmask "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("255.255")]),e._v(".255.0  broadcast "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.0")]),e._v(".8.0\n        ether 3a:37:f6:5a:bb:32  txqueuelen "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("100")]),e._v("  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("Ethernet"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n        RX packets "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("45125")]),e._v("  bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("8292906")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("7.9")]),e._v(" MiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n        RX errors "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  dropped "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  overruns "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  frame "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n        TX packets "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("16611")]),e._v("  bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2205218")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("2.1")]),e._v(" MiB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n        TX errors "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  dropped "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" overruns "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  carrier "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("  collisions "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("\n")])])]),n("h1",{attrs:{id:"openvpn-management-client-set-up"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#openvpn-management-client-set-up"}},[e._v("#")]),e._v(" OpenVPN Management Client Set-up")]),e._v(" "),n("ol",[n("li",[e._v("Generate the OpenVPN Server client certificate.")])]),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("Management is used as the name for the client PC.")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /etc/openvpn/easyrsa\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ./easyrsa build-client-full <client_name> nopass")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa build-client-full managment nopass\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Update certificate control file")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" ./easyrsa gen-crl\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[e._v("Create the OpenVPN Client profile file.")])]),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("Listed below are the configuration file and its corresponding names:")]),e._v(" "),n("ul",[n("li",[e._v("{ca} = CA certificate")]),e._v(" "),n("li",[e._v("{cert} = Client certificate")]),e._v(" "),n("li",[e._v("{key} = Client secret key")])])]),e._v(" "),n("p",[n("strong",[e._v("Certificate Locations")])]),e._v(" "),n("ul",[n("li",[e._v("The CA certificate is located in:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[e._v("/etc/openvpn/easyrsa/pki/ca.crt\n")])])]),n("ul",[n("li",[e._v("The Client certificate together with the Client secret key generated in the Client certificate section:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[e._v("/etc/openvpn/easyrsa/issued/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("client_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(".crt\n")])])]),n("ul",[n("li",[e._v("Client secret key:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[e._v("/etc/openvpn/easyrsa/private/"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("client_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v(".key\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("Open a text editor in your PC and copy the following template:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[e._v("dev tap\nclient\nremote "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("123.56")]),e._v(".96.211 "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("1194")]),e._v("\nproto udp\nnobind\nresolv-retry infinite\n\npersist-key\npersist-tun\n\nremote-cert-tls server\n\ncomp-lzo\nverb "),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# copy from openvpn-server /etc/openvpn/easyrsa/pki/ca.crt")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("ca"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n-----BEGIN CERTIFICATE-----\nMIIDNTCCAh2gAwIBAgIJANYEjCM+cqsxMA0GCSqGSIb3DQEBCwUAMBYxFDASBgNV\nBAMMC1JBS1dpcmVsZXNzMB4XDTE5MTEyNTAxMzIyOVoXDTI5MTEyMjAxMzIyOVow\nFjEUMBIGA1UEAwwLUkFLV2lyZWxlc3MwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw\nggEKAoIBAQDZS/8PCehr3TSTvidQLFVYT5EydKDVidEUm6/yOE0BZs99kZKGn6eF\nmFQnBfve4mAHzPnC3amiuCh+01kf97P7MDpS/cYTdR9RB9Xng/jyBQqMVVHLbwoG\nIS7mQmBpV0NdU8RYKsLCARPn50eRGiL2AS6cPDSjrrj2xsBEydTsjE/95gJ7AvWQ\nRPRoVTI9S31mY6tLrs16zydtEXWicDVaRFkvultijCmCiUhfaDE8lt1dQxd5jkvw\ncHtm1EBdHjyce7oXa+Og0p2c5EmTb1K2pjHZHG0jINv9lErC049g/ey7CcddDd+Q\nBm7fqArIaov7kk+U7zKhBrTVH3dmPWEHAgMBAAGjgYUwgYIwHQYDVR0OBBYEFLd+\neVD4IqyA84ABBeFupjEV0+bOMEYGA1UdIwQ/MD2AFLd+eVD4IqyA84ABBeFupjEV\n"),n("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("+bOoRqkGDAWMRQwEgYDVQQDDAtSQUtXaXJlbGVzc4IJANYEjCM+cqsxMAwGA1Ud\nEwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3DQEBCwUAA4IBAQABFT6ZgK7Y\ntM5tZEfEKSCMUxfESJ+4pPN2lryZVskXtD6BfjvKkQpj3A+R6MRNloOPvZ4spAvH\n5fFvfI97Ts40rQjWpgPLQDEBcgBi6dzzmMSap/iw9wLtgqWFVm+LXPMHQnqBKfs2\nHksTlKOhiKZlvtGYfxay6kbMU35LX8WdRxx8JNvRNIDL68lLdreXB7vTKQYAvcKP\no1GuZFqKV2KFxpjxzLg1BeM3U4X5k4xDQDaOHENKJO4pdWBfMLP3AAyC9wq481PO\nhgA1R8ZAt+psYxOAB6O3A1SzDJ/df5ciPdsp1Kia0HCB2cGIZ7ZwfzPDNivH8/bT\nn7UOb+khvmsD\n-----END CERTIFICATE-----\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("/ca"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Client certificate PEM")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Copy from server /etc/openvpn/easyrsa/pki/issued/managment.crt")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# ")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("cert"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n-----BEGIN CERTIFICATE-----\nMIIDTzCCAjegAwIBAgIQVm22YDcNRRzycbFHSEkkFjANBgkqhkiG9w0BAQsFADAW\nMRQwEgYDVQQDDAtSQUtXaXJlbGVzczAeFw0yMDAyMDUwMjI5MzZaFw0yMzAxMjAw\nMjI5MzZaMBcxFTATBgNVBAMMDFJBSzcyNThfNjY2NjCCASIwDQYJKoZIhvcNAQEB\nBQADggEPADCCAQoCggEBAK53T6vlbm4xVgM5z8fC6ul5WsdT3gfEGEOKu0MWcxq4\nYP0jrhXAwJV20EdUXYiFIOdf9woYvv8ANTFYHIBAT+jZrGhbhph7QSzmb1xzc3g/\nnGJVJAW7L10EmQ0mSsi64NTv/8Ou7wZQpqd8+FuIjDbMFJMP24GbqswG6nnhJCST\n1b1hfAgijK/dagRFJTcYhJcutwJrpUjhdAwVBG/GuXQwyI82WXzpqvVyfPgCb4Ek\n9ehHuA1Zsmgp68ChGFM+WrEZ1sETDlxlNAfsON7hihf3xYZ2iZ/6rq5RpUczJm3P\n9dxO74I8/dxe9TnNcIvqasxGg3jZW4UvQyATqnb+z5kCAwEAAaOBlzCBlDAJBgNV\nHRMEAjAAMB0GA1UdDgQWBBRQkqjMkMV4u8R0EKDDG08qjxJb4TBGBgNVHSMEPzA9\ngBS3fnlQ+CKsgPOAAQXhbqYxFdPmzqEapBgwFjEUMBIGA1UEAwwLUkFLV2lyZWxl\nc3OCCQDWBIwjPnK67dATBgNVHSUEDDAKBggrBgEFBQcDAjALBgNVHQ8EBAMCB4Aw\nDQYJKoZIhvcNAQELBQADggEBAGDGH6+b1EGkVj//EDyJUBISWWcXC8EwmrT25Tga\nWDid21QQatQahriVOFHu0B7DGSJb6kw4Om8Mz+kef1v529VIip56wP4I7aVQdcTg\nSoVBCc0ToXxGO+EXPWc0jBwPReofMzYeaZ+hZcSHeFOYAso5aFSMfk5Z7qwYQfaj\nZQ7AdTj2NcxH92bIv7JUzW6Xh8OcTuTzQd4J2dtJr4ObnRkYrqg27dzlV1dz73hJ\nJIs7AXUH4wivehV3VGd95am6ejs4Hedhaw23h+pV91LmG4gdb6EPHm0JPCHbaQAb\nJzF75JEh0CLOlDFBK419Dgg10n0gqLkSTcp+CzNlCx7k+24"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n-----END CERTIFICATE-----\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("/cert"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Client key PEM")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Copy from server /etc/openvpn/easyrsa/pki/private/managment.key")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("#")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("key"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n-----BEGIN PRIVATE KEY-----\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCud0+r5W5uMVYD\nOc/HwurpeVrHU94HxBhDirtDFnMauGD9I64VwMCVdtBHVF2IhSDnX/cKGL7/ADUx\nWByAQE/o2axoW4aYe0Es5m9cc3N4P5xiVSQFuy9dBJkNJkrIuuDU7//Dru8GUKan\nfPhbiIw2zBSTD9uBm6rMBup54SQkk9W9YXwIIoyv3WoERSU3GISXLrcCa6VI4XQM\nFQRvxrl0MMiPNll86ar1cnz4Am+BJPXoR7gNWbJoKevAoRhTPlqxGdbBEw5cZTQH\n7Dje4YoX98WGdomf+q6uUaVH11Ztz/XcTu+CPP3cXvU5zXCL6iIMRoN42VuFL0Mg\nE6p2/s+ZAgMBAAECggEAGGwPNQra2IYDelQfZ+E7LQ+Vy41L6V5j3yCOcie0WSsy\nOH1EIztmOgX1xeZjaXbpUjo2xK0OH3gR+iRRaQqXpQrDfaBCSRoH15cyQ4jNwyl0\nZLdyYXMAgE7iddrEYTD3xBcMgIH+Z63mhk+SHI4SwqDyyFtR6OS3lfPp4sHHY28r\nFJPXW7a10M+pxjEX+A8m3UM4VJiLy2YeklB7laJkQjHcA/Gh+sh/0NjZwCYyWWAi\nirATLDSa3z6N7yr3xAO/J4vEZVaGxyyJRvR4qmr0xE15xyCfQQcWdw1DpGT9uBk/\n4z/1Tq2sJUekzYebeENliJY3ADVsVS0JszRRHCYwGQKBgQDhRlwvrjvRP8ZCd9th\nssKXgkJBUSqxp8VvFtylMKy2koNq6S2S3yiGmiNWd7JxdGk+77MGmA8kTdpORMcN\nL9xSLMWiuMLHGEYf79TkON0ZBqN/wwuPttJG8ICWhqAjL+dDcLoqz8j4dO6FwKPo\nz+fVjVupXgYKfqLpm9SAD1apewKBgQDGQuyhzv0Ru7o29MDg5YZ0dwj9bV1KzlFf\n3DAdcX+k4Z48R50e5VhewIedA3eafy+UER63CAWLQru96sbRoGkk8aKBk9AGJPFb\ni4NVWWaiUA2A2WVUKkdIQsNrr2xHBTwiFPftTxWRWUT1DKgF+uHvSzBKfn13PReS\nKCjxzPis+wKBgQDVeW9yX5GfwOeHpTznYBa2rGFMtDXZFDssAmYkw/NnL4AJl93w\nCDjHFNnX3qXijYYOdecYoI/4vy3YbaSTAn+t/29pu9wX/xC0wvjjLF+Yj4nwUExs\na7roLpAsFHc74PEuH2zLlQvFJknBxcONozb2T3ZFESx4VXjcFydQEzj0cQKBgANq\nWbs73p40lrOlqcD2E0fkWRJMlQPZ5Ar7txR6xREpFdnB/hHvL4OKW4u36JKPyFkL\npnTOvZG1l5hg+AXadpU9WGhVDItejY3fLGcHAD6hlGn41McLZ2j2RXmQbxQWIgAQ\nTmkXKK71U7vI+QgJV2UQ7YcLAMxSEBrjeDkaJ9qLAoGAEiSjuv5X0PbZpiyH6/GX\nYuMhFYWZnk/IwoxQW4alBIRuI7EQ+fLvrFUxikMOIsLKtKrcVLjJBgFSz4hIE9YE\nYnaQ5Vx+RMzTwakRJtPook55pS1HpdK7Y/0oiUOsJGCEzVj8P/e/WrhFqWPGalIJ\nENCGBuhos/YdITFeKQ381zk"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("\n-----END PRIVATE KEY-----\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("<")]),e._v("/key"),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v(">")]),e._v("\n")])])]),n("ol",{attrs:{start:"4"}},[n("li",[e._v("Change the remote IP address with your Amazon Instance Public IP. Add each certificate in its corresponding section by copying the content from the locations mentioned above and replace the corresponding section in the template.")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/aws-instance-public-ip.png",width:"100%",caption:"AWS Instance Public IP"}}),e._v(" "),n("ol",{attrs:{start:"5"}},[n("li",[n("p",[e._v("Save the file with a name: "),n("strong",[e._v("management_client.ovpn")]),e._v(".")])]),e._v(" "),n("li",[n("p",[e._v("OpenVPN PC client.")])])]),e._v(" "),n("ul",[n("li",[n("p",[e._v("Download the "),n("a",{attrs:{href:"https://openvpn.net/community-downloads/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenVPN Client"),n("OutboundLink")],1),e._v(" and install.")])]),e._v(" "),n("li",[n("p",[e._v("Start the OpenVPN GUI Client. You will see an icon in the taskbar.")])])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/open-vpn-taskbar-icon.png",width:"75%",caption:"Open VPN Taskbar Icon"}}),e._v(" "),n("ul",[n("li",[e._v("Right click Import file and open management_client.ovpn file.")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/importing-openvpn-client-file.png",width:"100%",caption:"Importing OpenVPN Client File"}}),e._v(" "),n("ul",[n("li",[e._v("Make sure to go into the OpenVPN menu again and press Connect (it will not initiate automatically).")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/open-vpn-connection-initiation.png",width:"50%",caption:"Open VPN Connection initiation"}}),e._v(" "),n("p",[e._v("If everything is set up properly, a connection log window will disappear after the procedure runs through. Refer to Figure 5.")]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/open-vpn-connection-log2.png",width:"50%",caption:"Open VPN Connection log"}}),e._v(" "),n("p",[e._v("The OpenVPN should now be in green, see Figure 8, meaning the connection is successful. You can check which clients are currently connected to the OpenVPN Server and their corresponding IP addresses by executing the following command in your Ubuntu console:")]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/openvpn/server/ip_pool.txt \n")])])]),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/open-vpn-connected-clients1.png",width:"100%",caption:"Open VPN connected clients 1"}}),e._v(" "),n("p",[e._v("There should be only one client available and its IP address is visible now. This one client is the PC connected to the OpenVPN Server. Later, the Gateway also should be visible.")]),e._v(" "),n("h1",{attrs:{id:"openvpn-client-set-up-on-lora-gateway"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#openvpn-client-set-up-on-lora-gateway"}},[e._v("#")]),e._v(" OpenVPN Client Set-up on LoRa Gateway")]),e._v(" "),n("hr"),e._v(" "),n("p",[e._v("The procedure for generating the keys for the gateway is the same as the one for the Management PC, with the exception of a different Client name.")]),e._v(" "),n("div",{staticClass:"custom-block tip"},[n("p",{staticClass:"custom-block-title"},[e._v("üìù NOTE")]),e._v(" "),n("p",[e._v("You can go through Section 1 and 2 of OpenVPN Management Client Set-up again, and do the same procedure. Don't forget to replace the ‚Äú"),n("strong",[e._v("management")]),e._v("‚Äù name used for the Client with the one for the Gateway.")]),e._v(" "),n("ul",[n("li",[e._v("Used: "),n("strong",[e._v("rak7258-001")]),e._v(".")])])]),e._v(" "),n("p",[e._v("Once the certificates are assembled into a single file, you need to import the contents into the OpenVPN client section of your Gateway.")]),e._v(" "),n("ol",[n("li",[e._v("Log into the Gateway via the Web UI ("),n("strong",[e._v("locally")]),e._v(").")])]),e._v(" "),n("ul",[n("li",[n("p",[e._v("To access the WEB UI, make sure you still have local network access to your Gateway and connect to it.")])]),e._v(" "),n("li",[n("p",[e._v("In the sidebar menu section, go to the "),n("strong",[e._v("Services")]),e._v(" > "),n("strong",[e._v("OpenVPN Tunnels")]),e._v(" > "),n("strong",[e._v("Enter a name")]),e._v(" > choose ‚Äú"),n("strong",[e._v("Custom Openvpn Configuration")]),e._v("‚Äù from the drop-down and the press "),n("strong",[e._v("Add")]),e._v(". Use Figure 10 as reference.")])])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/creating-an-openvpn-tunnel.jpg",width:"100%",caption:"Creating an OpenVPN tunnel"}}),e._v(" "),n("ul",[n("li",[e._v("In the next window, simply "),n("strong",[e._v("copy/paste")]),e._v(" the content of the file you created in the beginning and click "),n("strong",[e._v("Save & Apply")]),e._v(". See Figure 11 below.")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/importing-the-openvpn-certificate-data.png",width:"100%",caption:"Importing the OpenVPN certificate data"}}),e._v(" "),n("ul",[n("li",[e._v("Shown in Figure 12, go back to the "),n("strong",[e._v("OpenVPN Tunnel")]),e._v("s section > tap "),n("strong",[e._v("Enable")]),e._v(" to on state > click "),n("strong",[e._v("Save & Apply")]),e._v(". This will finalize things and the Gateway should now be connected to the OpenVPN Server. The process might take a few minutes to complete.")])]),e._v(" "),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/enabling-openvpn.png",width:"100%",caption:"Enabling OpenVPN"}}),e._v(" "),n("ul",[n("li",[e._v("Check again in the client list file on the OpenVPN Server for the IP address of the Gateway:")])]),e._v(" "),n("div",{staticClass:"language-sh extra-class"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("nano")]),e._v(" /etc/openvpn/server/ip_pool.txt \n")])])]),n("rk-img",{attrs:{src:"/assets/images/deployment-guide/gateway-remote-management-openvpn/openvpn-connected-clients2.png",width:"100%",caption:"OpenVPN connected-clients 2"}}),e._v(" "),n("p",[e._v("The IP address of the Gateway should be in the second entry.")]),e._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[e._v("Log into the Gateway ("),n("strong",[e._v("remotely")]),e._v(")")])]),e._v(" "),n("p",[e._v("You can now log into the Gateway by using the IP address, shown in Figure 13, assigned to it by the OpenVPN Server. This can be utilized for an SSH2 connection or the Web UI (via a browser).")])],1)}),[],!1,null,null,null);t.default=s.exports}}]);